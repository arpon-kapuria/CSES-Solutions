#!/bin/bash

# Check input
if [ -z "$1" ]; then
    echo "‚ùå Usage: ./run path/to/file.cpp"
    exit 1
fi

SOURCE="$1"

# Ensure file exists
if [ ! -f "$SOURCE" ]; then
    echo "‚ùå File not found: $SOURCE"
    exit 1
fi

# Create build directory if missing
mkdir -p build

# Generate binary name: folder1/foo.cpp ‚Üí folder1_foo
BASENAME=$(basename "$SOURCE" .cpp)
DIRNAME=$(dirname "$SOURCE" | sed 's/\//_/g')
BIN="build/${DIRNAME}_${BASENAME}"

# Compile
echo "üîß Compiling $SOURCE ‚Üí $BIN"
g++ -std=c++17 -Wall -Wextra -O2 "$SOURCE" -o "$BIN"
if [ $? -ne 0 ]; then
    echo "‚ùå Compilation failed"
    exit 1
fi

# Run
echo "üöÄ Running $BIN"
"./$BIN"
